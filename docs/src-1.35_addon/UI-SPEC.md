# UI-SPEC — 画面仕様

## 1. 共通
- レイアウト: 左=手入力、右=生成、下=統合（3ペイン）。
- **仮想スクロール**（100–1000カード対応）。
- D&D 並べ替え、Undo/Redo、キーボード（↑↓ / PgUp/PgDn / Ctrl+Enter）。

## 2. ビュー種別
### 2.1 グリッド
- 固定サイズカード。タイトル／タグ／トーン／ロックのバッジ。
- クリックで詳細（右/下ペインに反映）。

### 2.2 モザイク
- 可変高さ（manual/ai の文字量に比例）。列幅はレスポンシブ。
- 高さは計測後キャッシュ（jank回避）。

### 2.3 タイムライン
- `durationSec` を横軸にマッピング。ズーム ±、スクラブ、スナップ（0.5s）。
- 選択範囲を下ペインで統合可能。

### 2.4 カンバン
- 列: `status`（draft/need_ai/review/locked 等）。列間D&Dで状態遷移。
- 列ヘッダに数（WIPメトリクス）。

## 3. 右ペイン（生成）
- v1.0 は **local‑mock** モードのみ表示：
  - テンプレ展開（snippetsの簡易版）
  - 要約/整形（ルールベース）
  - 差分表示（左とのdiff、ハイライト）
- 将来 `external-llm` に切替可能なUIスイッチを**非表示**で持つ。

## 4. 下ペイン（統合）
- 自動採用／衝突／手動編集を切替。
- しきい値スライダー（0.0–1.0、既定0.72）。
- 採用時はハイライトを消し、履歴へスナップショット保存。

### 4.1 MergeDock Phase コントロール
- `resolveMergeDockPhasePlan()` が `merge.precision` と `conimg.merge.threshold` を組み合わせ、しきい値スライダーのレンジと Diff タブ露出を制御する。
- legacy: スライダー範囲 `0.65–0.9`、Diff タブは非表示。
- beta: スライダー範囲 `0.68–0.9`。Review band（`threshold-0.02`〜`threshold+0.05`）にハンクが残る場合のみ Diff タブを opt-in 表示。
- stable: スライダー範囲 `0.7–0.94`。Review または Conflict band にハンクがあれば Diff タブを既定タブとして露出し、自動採用ターゲットを `threshold+0.03` に固定。

## 5. 保存インジケータ
- `●`（未保存） / `○`（保存済）/ `↻`（AutoSave中）をタイトルバーに表示。

## 6. アクセシビリティ
- フォーカスリング、ARIAロール、ラベル適用。
- キーボードのみで全操作可能。
