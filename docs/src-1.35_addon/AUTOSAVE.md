# AUTOSAVE — 保存仕様

## 1. 目的
- 編集中の喪失を防ぎ、**2.5秒以内に永続化**。
- 破損防止のため**アトミック保存**を行う。

## 2. アルゴリズム
- 入力発生→**デバウンス ~500ms**。アイドル2sで確定。
- 保存手順: `write(tmp)` → `fsync` → `rename(tmp -> target)`。
- 成功時に `history/<iso>.json` へ世代保存（N=20 / 合計50MB）。

## 3. UI
- インジケータ：`↻`（保存中）→`○`（保存済）。
- 復旧ダイアログ：起動時に履歴あり・破損時は選択復旧。

## 4. 排他
- PWA単一タブ前提。拡張化時は拡張側で擬似ロックを付与。

